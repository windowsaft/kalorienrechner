<!DOCTYPE html>
<html lang="de">
  <style>
    table {
      width: 100%;
    }

    table, th, td {
      border:1px solid black;
    }

    th {
      background-color: #c3c3c3; /* distinct header style */
    }

    #sum-table tbody tr:hover {
      background-color: #008080; /* Highlight row on hover */
    }

    th, td {
      width: 20%;
    }

    #portion-weight input {
      width: 100%;
      box-sizing: border-box; /* Includes padding in width */
    }
  </style>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kalorienrechner für Rezepte</title>
</head>
<body>
  <h1>Kalorienrechner für Rezepte</h1>
  <br>
  <h2>Eingabe-Matrix</h2>
  <table id="sum-table">
    <thead>
      <tr>
        <th>Zutat</th>
        <th>Gewicht (g)</th>
        <th>Kalorien</th>
        <th>Kohlenhydrate (g)</th>
        <th>Fett (g)</th>
        <th>Protein (g)</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><input type="text" placeholder="Zutat"></td>
        <td><input type="number" placeholder="Gewicht (g)" oninput="calculateSums()"></td>
        <td><input type="number" placeholder="Kalorien" oninput="calculateSums()"></td>
        <td><input type="number" placeholder="Kohlenhydrate (g)" oninput="calculateSums()"></td>
        <td><input type="number" placeholder="Fett (g)" oninput="calculateSums()"></td>
        <td><input type="number" placeholder="Protein (g)" oninput="calculateSums()"></td>
      </tr>
      <tr>
        <td><input type="text" placeholder="Zutat"></td>
        <td><input type="number" placeholder="Gewicht (g)" oninput="calculateSums()"></td>
        <td><input type="number" placeholder="Kalorien" oninput="calculateSums()"></td>
        <td><input type="number" placeholder="Kohlenhydrate (g)" oninput="calculateSums()"></td>
        <td><input type="number" placeholder="Fett (g)" oninput="calculateSums()"></td>
        <td><input type="number" placeholder="Protein (g)" oninput="calculateSums()"></td>
      </tr>
    </tbody>
    <tfoot>
      <tr>
        <td><strong>Summe:</strong></td>
        <td id="total-weight">0.00</td>
        <td id="total-calories">0.00</td>
        <td id="total-carbs">0.00</td>
        <td id="total-fat">0.00</td>
        <td id="total-protein">0.00</td>
      </tr>
      <tr>
        <td colspan="6" style="text-align: center;">
          <button onclick="addRow()">Neue Zeile hinzufügen</button>
        </td>
      </tr>
    </tfoot>
  </table>
  </br>
  <h2>Portionsrechner</h2>
  <table id="portion-table">
    <thead>
      <tr>
        <th>Gewicht (g)</th>
        <th>Kalorien</th>
        <th>Kohlenhydrate (g)</th>
        <th>Fett (g)</th>
        <th>Protein (g)</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td id="portion-weight"><input type="number" placeholder="Gewicht (g)" oninput="calculatePortion()"></td>
        <td id="portion-calories">0.00</td>
        <td id="portion-carbs">0.00</td>
        <td id="portion-fat">0.00</td>
        <td id="portion-protein">0.00</td>
      </tr>
    </tbody>
  </table>
</body>
<script>
  // Function to calculate sums
  function calculateSums() {
    const table = document.getElementById("sum-table")
    const rows = table.querySelectorAll("tbody tr");
    let totalWeight = 0;
    let totalCalories = 0;
    let totalCarbs = 0;
    let totalFat = 0;
    let totalProtein = 0;

    rows.forEach(row => {
      const cells = row.querySelectorAll("td input");
      totalWeight += parseFloat(cells[1].value) || 0;
      totalCalories += parseFloat(cells[2].value) || 0;
      totalCarbs += parseFloat(cells[3].value) || 0;
      totalFat += parseFloat(cells[4].value) || 0;
      totalProtein += parseFloat(cells[5].value) || 0;
    });

    // Update the total row
    document.getElementById("total-weight").textContent = totalWeight.toFixed(2);
    document.getElementById("total-calories").textContent = totalCalories.toFixed(2);
    document.getElementById("total-carbs").textContent = totalCarbs.toFixed(2);
    document.getElementById("total-fat").textContent = totalFat.toFixed(2);
    document.getElementById("total-protein").textContent = totalProtein.toFixed(2);
  }


  // Function to add a new row
  function addRow() {
    const table = document.getElementById("sum-table")
    const tbody = table.querySelector("tbody");
    const newRow = document.createElement("tr");
    newRow.innerHTML = `
      <td><input type="text" placeholder="Zutat"></td>
      <td><input type="number" placeholder="Gewicht (g)" oninput="calculateSums()"></td>
      <td><input type="number" placeholder="Kalorien" oninput="calculateSums()"></td>
      <td><input type="number" placeholder="Kohlenhydrate (g)" oninput="calculateSums()"></td>
      <td><input type="number" placeholder="Fett (g)" oninput="calculateSums()"></td>
      <td><input type="number" placeholder="Protein (g)" oninput="calculateSums()"></td>
    `;
    tbody.appendChild(newRow);
  }


  // Function to calculate the portion
  function calculatePortion() {
    // Collect all sums
    const ids = ["total-weight", "total-calories", "total-carbs", "total-fat", "total-protein"];
    const totalMap = {}
    ids.forEach(id => {
      const numAsText = document.getElementById(id).textContent
      totalMap[id] = parseFloat(numAsText)
    });

    // Collect portion weight
    const portionWeightAsText = document.getElementById("portion-weight").querySelector("input").value;
    const portionWeight = parseFloat(portionWeightAsText);

    // Calculate portion values
    const portionCalories = portionWeight / totalMap["total-weight"] * totalMap["total-calories"];
    const portionCarbs = portionWeight / totalMap["total-weight"] * totalMap["total-carbs"];
    const portionFat = portionWeight / totalMap["total-weight"] * totalMap["total-fat"];
    const portionProtein = portionWeight / totalMap["total-weight"] * totalMap["total-protein"];

    // Update the portion row
    document.getElementById("portion-calories").textContent = portionCalories.toFixed(2);
    document.getElementById("portion-carbs").textContent = portionCarbs.toFixed(2);
    document.getElementById("portion-fat").textContent = portionFat.toFixed(2);
    document.getElementById("portion-protein").textContent = portionProtein.toFixed(2);
  }
</script>
</html>
